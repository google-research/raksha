#include "taint.dl"
#include "fact_test_helper.dl"
#include "integrity_tag_prop_helper.dl"

// "d" has 3 children, "a", "b", and "c"
edge("a", "d").
edge("b", "d").
edge("c", "d").

directHasIntegrityTag("a", "defaultOwner", "integ1").
directHasIntegrityTag("b", "defaultOwner", "integ1").
directHasIntegrityTag("c", "defaultOwner", "integ1").

expectHasIntegrityTag("a", "defaultOwner", "integ1").
expectHasIntegrityTag("b", "defaultOwner", "integ1").
expectHasIntegrityTag("c", "defaultOwner", "integ1").
expectHasIntegrityTag("d", "defaultOwner", "integ1").

directHasIntegrityTag("a", "defaultOwner", "integ2").
directHasIntegrityTag("b", "defaultOwner", "integ2").
expectHasIntegrityTag("a", "defaultOwner", "integ2").
expectHasIntegrityTag("b", "defaultOwner", "integ2").

directHasIntegrityTag("a", "defaultOwner", "integ3").
directHasIntegrityTag("c", "defaultOwner", "integ3").
expectHasIntegrityTag("a", "defaultOwner", "integ3").
expectHasIntegrityTag("c", "defaultOwner", "integ3").

directHasIntegrityTag("b", "defaultOwner", "integ4").
directHasIntegrityTag("c", "defaultOwner", "integ4").
expectHasIntegrityTag("b", "defaultOwner", "integ4").
expectHasIntegrityTag("c", "defaultOwner", "integ4").

directHasIntegrityTag("d", "defaultOwner", "integ5").
expectHasIntegrityTag("d", "defaultOwner", "integ5").
